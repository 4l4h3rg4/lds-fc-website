---
import Layout from "../layouts/Layout.astro";
import { MessageSquare, Heart } from "lucide-react";

import { supabase } from "../lib/supabase";

const { data: storiesData } = await supabase.from('stories').select('*');
const stories = storiesData || [];
---

<Layout title="LDS FC | La Tribuna">
    <main class="max-w-6xl mx-auto px-6 pt-32 pb-20 overflow-hidden">
        
        <!-- HEADER SECTION -->
        <div class="relative mb-24 text-center">

            <!-- Foreground "LA TRIBUNA" -->
            <div class="relative z-10 inline-block">
                <h1 class="font-graffiti text-6xl md:text-9xl leading-none uppercase tracking-tighter relative">
                    LA TRIBUNA
                </h1>
                
                <!-- #LDS_OFFICIAL Sticker -->
                <div class="absolute -bottom-4 right-0 md:-right-12 bg-white text-black font-graffiti text-sm md:text-xl px-4 py-1 transform -rotate-6 border-2 border-black shadow-[4px_4px_0px_0px_rgba(255,255,255,0.2)]">
                    #LDS_OFFICIAL
                </div>
            </div>
        </div>

        <!-- MURO DE LOS LAMENTOS SECTION -->
        <section class="max-w-4xl mx-auto relative">
            <!-- CARDS GRID -->
            <div class="space-y-12">
                {stories.map((s) => (
                    <div class="relative group">
                        <!-- Red Pin -->
                        <div class="absolute -top-3 left-1/2 -translate-x-1/2 z-20 w-6 h-6 rounded-full bg-[#E63946] border-2 border-[rgba(0,0,0,0.2)] shadow-md"></div>
                        
                        <!-- Paper Card -->
                        <div class="bg-[#f0f0f0] p-8 md:p-10 shadow-xl transform transition-transform duration-300 hover:scale-[1.01] hover:rotate-1 relative z-10 paper-texture box-shadow-paper">
                            <p class=" text-2xl md:text-3xl text-black leading-normal mb-8 uppercase">
                                "{s.body}"
                            </p>
                            
                            <div class="flex items-center justify-between border-t border-black/10 pt-4">
                                <span class="font-heading text-xl text-black uppercase">
                                    {s.author}
                                </span>
                            </div>
                        </div>
                    </div>
                ))}
            </div>

            <!-- CREATE POST BUTTON -->
            <div class="mt-20 flex justify-center">
                <a href="#post" class="group relative inline-block">
                    <div class="absolute inset-0 bg-[var(--color-neon-cyan)] transform translate-x-2 translate-y-2 transition-transform group-hover:translate-x-3 group-hover:translate-y-3"></div>
                    <div class="relative bg-black border-2 border-[var(--color-neon-cyan)] px-8 py-4 flex items-center gap-4">
                        <MessageSquare className="text-[var(--color-neon-cyan)]" />
                        <span class="font-heading text-2xl text-white uppercase">Dejar mi mensaje</span>
                    </div>
                </a>
            </div>

        </section>
    </main>
</Layout>

<style>
    .paper-texture {
        background-color: #f0f0f0;
        background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.05'/%3E%3C/svg%3E");
    }
    .box-shadow-paper {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.3);
    }
</style>
