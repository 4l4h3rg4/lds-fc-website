import{c as X,j as e,X as q}from"./x.ruB7mzul.js";import{r as c}from"./index.WFquGv8Z.js";import{s as d}from"./supabase.DaSDeVGQ.js";import{P as $,S as O,a as I}from"./save.BxNAuNl1.js";import{T as M}from"./trash-2.DZI-MssB.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],z=X("check",A);function B(){const[f,y]=c.useState([]),[N,w]=c.useState([]),[g,v]=c.useState(!0),[k,x]=c.useState(!1),[p,m]=c.useState(null),[s,n]=c.useState({status:"NEXT",type:"Amistoso"}),[i,u]=c.useState([]);c.useEffect(()=>{h()},[]);const T=t=>[...t].sort((r,a)=>{if(r.status==="NEXT"&&a.status!=="NEXT")return-1;if(r.status!=="NEXT"&&a.status==="NEXT")return 1;const o=new Date(`${r.date}T${r.time||"00:00"}`),l=new Date(`${a.date}T${a.time||"00:00"}`);return isNaN(o.getTime())||isNaN(l.getTime())?a.date.localeCompare(r.date):r.status==="NEXT"?o.getTime()-l.getTime():l.getTime()-o.getTime()}),h=async()=>{v(!0);const{data:t}=await d.from("matches").select("*, match_players(*)"),{data:r}=await d.from("players").select("*").order("number",{ascending:!0});t&&y(T(t)),r&&w(r),v(!1)},_=t=>t&&t.match(/^\d{4}-\d{2}-\d{2}$/)?t:"",E=t=>{n({rival:t.rival,date:t.date,time:t.time,place:t.place,status:t.status,result:t.result||"",type:t.type});const r=t.match_players?.map(a=>({player_id:a.player_id,is_starter:a.is_starter,goals:a.goals||0}))||[];u(r),m(t.id),x(!0)},C=async t=>{if(!confirm("¿Seguro que querés borrar este partido?"))return;const{error:r}=await d.from("matches").delete().eq("id",t);r?alert("Error borrando partido."):h()},P=t=>{i.find(r=>r.player_id===t)?u(i.filter(r=>r.player_id!==t)):u([...i,{player_id:t,is_starter:!1,goals:0}])},j=(t,r,a)=>{u(i.map(o=>o.player_id===t?{...o,[r]:a}:o))},S=async t=>{t.preventDefault();try{let r=p;const a={rival:s.rival,date:s.date,time:s.time,place:s.place,status:s.status,result:s.result||null,type:s.type};if(p){const{error:o}=await d.from("matches").update(a).eq("id",p);if(o)throw o}else{const{data:o,error:l}=await d.from("matches").insert([a]).select();if(l)throw l;r=o[0].id}if(!r)throw new Error("No Match ID");if(await d.from("match_players").delete().eq("match_id",r),i.length>0){const o=i.map(b=>({match_id:r,player_id:b.player_id,is_starter:b.is_starter,goals:b.goals})),{error:l}=await d.from("match_players").insert(o);if(l)throw l}x(!1),m(null),n({status:"NEXT",type:"Amistoso"}),u([]),h()}catch(r){alert("Error guardando partido"),console.error(r)}},D=()=>{const t=new Date,r=t.toISOString().split("T")[0],a=t.toTimeString().slice(0,5);n({status:"NEXT",type:"Amistoso",date:r,time:a,place:"Cancha"}),u([]),m(null),x(!0)};return g?e.jsx("div",{className:"text-white font-mono p-12 text-center animate-pulse",children:"Cargando Partidos..."}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"font-heading text-3xl text-white uppercase",children:"Gestión de Partidos"}),e.jsxs("button",{onClick:D,className:"bg-[var(--color-neon-cyan)] text-black font-bold uppercase text-xs px-4 py-2 hover:bg-white transition-colors flex items-center gap-2",children:[e.jsx($,{size:16})," Nuevo Partido"]})]}),k&&e.jsxs("div",{className:"bg-[#111] border border-white/20 p-6 rounded-sm mb-8 animate-fade-in shadow-2xl shadow-black/50",children:[e.jsxs("div",{className:"flex justify-between mb-6 border-b border-white/10 pb-4",children:[e.jsx("h3",{className:"text-white font-heading text-xl uppercase",children:p?"Editar Partido":"Nuevo Partido"}),e.jsx("button",{onClick:()=>x(!1),className:"text-neutral-500 hover:text-white",children:e.jsx(q,{})})]}),e.jsxs("form",{onSubmit:S,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 pb-6 border-b border-white/10",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Rival"}),e.jsx("input",{className:"w-full bg-black border border-white/20 text-white px-3 py-3 text-sm focus:border-[var(--color-neon-cyan)] outline-none transition-colors placeholder:text-neutral-700",value:s.rival||"",onChange:t=>n({...s,rival:t.target.value}),required:!0,placeholder:"Nombre del rival"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Fecha"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"date",className:"w-full bg-black border border-white/20 text-white px-3 py-3 text-sm focus:border-[var(--color-neon-cyan)] outline-none transition-colors cursor-pointer appearance-none [&::-webkit-calendar-picker-indicator]:invert",value:_(s.date),onChange:t=>n({...s,date:t.target.value}),onClick:t=>t.currentTarget.showPicker(),required:!0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Hora"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"time",className:"w-full bg-black border border-white/20 text-white px-3 py-3 text-sm focus:border-[var(--color-neon-cyan)] outline-none transition-colors cursor-pointer appearance-none [&::-webkit-calendar-picker-indicator]:invert",value:s.time||"",onChange:t=>n({...s,time:t.target.value}),onClick:t=>t.currentTarget.showPicker(),required:!0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Cancha / Lugar"}),e.jsx("input",{className:"w-full bg-black border border-white/20 text-white px-3 py-3 text-sm focus:border-[var(--color-neon-cyan)] outline-none transition-colors",value:s.place||"",onChange:t=>n({...s,place:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Estado"}),e.jsxs("select",{className:"w-full bg-black border border-white/20 text-white px-3 py-3 text-sm focus:border-[var(--color-neon-cyan)] outline-none",value:s.status,onChange:t=>n({...s,status:t.target.value}),children:[e.jsx("option",{value:"NEXT",children:"Próximo"}),e.jsx("option",{value:"WON",children:"Ganado"}),e.jsx("option",{value:"DRAW",children:"Empatado"}),e.jsx("option",{value:"LOST",children:"Perdido"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Resultado"}),e.jsx("input",{className:"w-full bg-black border border-white/20 text-white px-3 py-3 text-sm focus:border-[var(--color-neon-cyan)] outline-none transition-colors",value:s.result||"",onChange:t=>n({...s,result:t.target.value}),placeholder:"Ej: 3 - 1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Tipo"}),e.jsx("input",{className:"w-full bg-black border border-white/20 text-white px-3 py-3 text-sm focus:border-[var(--color-neon-cyan)] outline-none transition-colors",value:s.type||"",onChange:t=>n({...s,type:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-[var(--color-neon-cyan)] font-mono text-xs uppercase tracking-widest mb-4",children:["Convocados (",i.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 max-h-96 overflow-y-auto pr-2 custom-scrollbar",children:N.map(t=>{const r=i.find(a=>a.player_id===t.id);return e.jsxs("div",{className:`p-3 border rounded-sm transition-all select-none ${r?"border-[var(--color-neon-cyan)] bg-[var(--color-neon-cyan)]/5":"border-white/10 bg-neutral-900/50 hover:border-white/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{onClick:()=>P(t.id),className:`w-5 h-5 border cursor-pointer flex items-center justify-center transition-colors ${r?"bg-[var(--color-neon-cyan)] border-[var(--color-neon-cyan)] text-black":"border-white/30 hover:border-white"}`,children:r&&e.jsx(z,{size:14})}),e.jsx("span",{className:`font-heading text-sm uppercase ${r?"text-white":"text-neutral-500"}`,children:t.name})]}),r&&e.jsxs("div",{className:"pl-8 flex items-center gap-4 animate-fade-in",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r.is_starter,onChange:a=>j(t.id,"is_starter",a.target.checked),className:"accent-[var(--color-neon-cyan)]"}),e.jsx("span",{className:"text-[10px] font-mono uppercase text-neutral-400",children:"Titular"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] font-mono uppercase text-neutral-400",children:"Goles:"}),e.jsx("input",{type:"number",min:"0",value:r.goals,onChange:a=>j(t.id,"goals",parseInt(a.target.value)||0),className:"w-12 bg-black border border-white/20 text-white text-xs px-1 py-0.5 text-center focus:border-[var(--color-neon-cyan)] outline-none"})]})]})]},t.id)})})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-white/10",children:e.jsxs("button",{type:"submit",className:"bg-white text-black font-bold uppercase text-xs px-6 py-3 hover:bg-[var(--color-neon-cyan)] transition-colors flex items-center gap-2 cursor-pointer",children:[e.jsx(O,{size:16})," Guardar Partido"]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[f.map(t=>e.jsxs("div",{className:`bg-[#111] border p-4 flex flex-col md:flex-row items-center justify-between group transition-colors ${t.status==="NEXT"?"border-[var(--color-neon-cyan)]/30 shadow-[0_0_15px_-5px_var(--color-neon-cyan)]":"border-white/10 hover:border-white/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-6 mb-4 md:mb-0 w-full md:w-auto",children:[e.jsx("div",{className:`w-2 h-12 shrink-0 ${t.status==="NEXT"?"bg-[var(--color-neon-cyan)]":t.status==="WON"?"bg-green-500":t.status==="LOST"?"bg-red-500":"bg-neutral-500"}`}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-mono text-xs text-neutral-500 mb-1 flex items-center gap-2",children:[t.status==="NEXT"&&e.jsx("span",{className:"animate-pulse w-2 h-2 rounded-full bg-[var(--color-neon-cyan)]"}),t.date," - ",t.time]}),e.jsxs("h4",{className:"text-white font-heading text-xl uppercase",children:["vs ",t.rival]}),e.jsxs("p",{className:"text-neutral-400 text-xs mt-1",children:[t.place," • ",t.type]})]})]}),e.jsxs("div",{className:"flex items-center gap-8 w-full md:w-auto justify-between md:justify-end",children:[e.jsx("div",{className:"text-center",children:t.result?e.jsx("span",{className:`font-heading text-2xl ${t.status==="WON"?"text-green-500":"text-white"}`,children:t.result}):e.jsx("span",{className:"text-[10px] font-mono text-[var(--color-neon-cyan)] uppercase border border-[var(--color-neon-cyan)] px-2 py-1",children:"Próximo"})}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>E(t),className:"text-cyan-400 hover:text-cyan-300 p-2",children:e.jsx(I,{size:16})}),e.jsx("button",{onClick:()=>C(t.id),className:"text-red-500 hover:text-red-400 p-2",children:e.jsx(M,{size:16})})]})]})]},t.id)),f.length===0&&!g&&e.jsx("div",{className:"text-neutral-500 text-center py-12 border border-white/10 border-dashed rounded-sm",children:"No hay partidos registrados"})]})]})}export{B as default};
