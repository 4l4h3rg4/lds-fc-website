import{j as e,X as y}from"./x.ruB7mzul.js";import{r as l}from"./index.WFquGv8Z.js";import{s as n}from"./supabase.DaSDeVGQ.js";import{I as k}from"./ImageUpload.CqBazWyq.js";import{P as S,S as _,a as C}from"./save.BxNAuNl1.js";import{T as q}from"./trash-2.DZI-MssB.js";function F(){const[m,p]=l.useState([]),[b,h]=l.useState([]),[f,u]=l.useState(!0),[c,d]=l.useState(null),[s,r]=l.useState({}),[g,o]=l.useState(!1);l.useEffect(()=>{x()},[]);const x=async()=>{u(!0);const{data:t}=await n.from("products").select("*, badge:badges(text,color)").order("created_at",{ascending:!1}),{data:a}=await n.from("badges").select("*");t&&p(t),a&&h(a),u(!1)},j=t=>{r({title:t.title,description:t.description,price:t.price,image:t.image,badge_id:t.badge_id}),d(t.id),o(!0)},v=async t=>{if(!confirm("¿Seguro que querés borrar este producto?"))return;const{error:a}=await n.from("products").delete().eq("id",t);a||x()},w=async t=>{t.preventDefault();try{const a={title:s.title,description:s.description,price:s.price,image:s.image,badge_id:s.badge_id||null};if(c){const{error:i}=await n.from("products").update(a).eq("id",c);if(i)throw i}else{const{error:i}=await n.from("products").insert([a]);if(i)throw i}o(!1),d(null),r({}),x()}catch(a){alert("Error guardando producto"),console.error(a)}},N=()=>{r({}),d(null),o(!0)};return f?e.jsx("div",{className:"text-white font-mono p-12 text-center",children:"Cargando Tienda..."}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"font-heading text-3xl text-white uppercase",children:"Gestión de Tienda"}),e.jsxs("button",{onClick:N,className:"bg-[var(--color-neon-cyan)] text-black font-bold uppercase text-xs px-4 py-2 hover:bg-white transition-colors flex items-center gap-2",children:[e.jsx(S,{size:16})," Nuevo Producto"]})]}),g&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-[#111] border border-white/20 p-6 md:p-8 rounded-sm w-full max-w-4xl relative shadow-[0_0_50px_rgba(0,0,0,0.5)] max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between mb-6",children:[e.jsx("h3",{className:"text-white font-heading text-2xl uppercase",children:c?"Editar Producto":"Nuevo Producto"}),e.jsx("button",{onClick:()=>o(!1),className:"text-neutral-500 hover:text-white p-2",children:e.jsx(y,{size:24})})]}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Título"}),e.jsx("input",{className:"w-full bg-black border border-white/20 text-white px-4 py-3 focus:border-[var(--color-neon-cyan)] outline-none",value:s.title||"",onChange:t=>r({...s,title:t.target.value}),required:!0})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Descripción"}),e.jsx("textarea",{className:"w-full bg-black border border-white/20 text-white px-4 py-3 focus:border-[var(--color-neon-cyan)] h-24 outline-none resize-none",value:s.description||"",onChange:t=>r({...s,description:t.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Precio"}),e.jsx("input",{className:"w-full bg-black border border-white/20 text-white px-4 py-3 focus:border-[var(--color-neon-cyan)] outline-none",value:s.price||"",onChange:t=>r({...s,price:t.target.value}),required:!0,placeholder:"$10.000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Etiqueta (Badge)"}),e.jsxs("select",{className:"w-full bg-black border border-white/20 text-white px-4 py-3 focus:border-[var(--color-neon-cyan)] outline-none",value:s.badge_id||"",onChange:t=>r({...s,badge_id:t.target.value}),children:[e.jsx("option",{value:"",children:"Sin etiqueta"}),b.map(t=>e.jsx("option",{value:t.id,children:t.text},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-neutral-400 uppercase mb-2",children:"Foto"}),e.jsx("div",{className:"max-w-xs",children:e.jsx(k,{folder:"products",currentImage:s.image,onUpload:t=>r({...s,image:t})})})]}),e.jsxs("div",{className:"flex justify-end pt-4 pb-2 border-t border-white/10 sticky bottom-0 bg-[#111] z-10 shadow-[0_-20px_30px_rgba(0,0,0,0.5)]",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:"mr-4 text-white font-bold uppercase text-xs px-6 py-3 hover:text-neutral-300 transition-colors",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"bg-white text-black font-bold uppercase text-xs px-8 py-3 hover:bg-[var(--color-neon-cyan)] transition-colors flex items-center gap-2 shadow-lg",children:[e.jsx(_,{size:18})," Guardar"]})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(t=>e.jsxs("div",{className:"bg-[#111] border border-white/10 p-5 group hover:border-[var(--color-neon-cyan)]/30 transition-all duration-300 flex flex-col",children:[e.jsxs("div",{className:"w-full aspect-square bg-neutral-800 mb-4 overflow-hidden relative",children:[t.image?e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-neutral-600 font-bold",children:"SIN FOTO"}),t.badge&&e.jsx("span",{className:"absolute top-2 right-2 px-2 py-1 text-[10px] uppercase font-bold text-black bg-[var(--color-neon-cyan)]",children:t.badge.text})]}),e.jsx("div",{className:"flex justify-between items-start mb-2",children:e.jsx("h4",{className:"text-white font-heading text-lg uppercase truncate flex-1 pr-2",children:t.title})}),e.jsx("p",{className:"text-neutral-500 text-sm mb-4 line-clamp-2 h-10 flex-1",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between mt-auto pt-4 border-t border-white/5",children:[e.jsx("p",{className:"text-[var(--color-neon-cyan)] font-heading text-xl",children:t.price}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>j(t),className:"bg-[#222] hover:bg-white hover:text-black text-white p-2 transition-colors border border-white/10",title:"Editar",children:e.jsx(C,{size:18})}),e.jsx("button",{onClick:()=>v(t.id),className:"bg-[#222] hover:bg-red-600 hover:text-white text-white p-2 transition-colors border border-white/10",title:"Eliminar",children:e.jsx(q,{size:18})})]})]})]},t.id))})]})}export{F as default};
